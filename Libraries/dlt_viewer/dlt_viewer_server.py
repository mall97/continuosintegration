#!/usr/bin/env python3
####################################################################################################################
###-                            {DLT Viewer Remote Server}                                                      ##-#
###-Connect Robot framework with remote DLT Viewer                                                              ##-#
###-Author: Raquel Ribeiro                                                                                      ##-#
###-Comment by:                                                                                                 ##-#
####################################################################################################################

####################################################################################################################
# -----------------------------------------------------------------------------
# imports
# -----------------------------------------------------------------------------
####################################################################################################################
from robotremoteserver import RobotRemoteServer
from dlt_viewer_api    import Api
####################################################################################################################
# -----------------------------------------------------------------------------
# main
# -----------------------------------------------------------------------------
####################################################################################################################
def main(params):
    try:
        # -----------------------------------------------------------------------------
        # Start server
        # -----------------------------------------------------------------------------
        api = Api(params)
        RobotRemoteServer(api, host=str(params['ip']), port=int(params['port']))
    except Exception as e:
        print(str(e))
####################################################################################################################
# -----------------------------------------------------------------------------
# run
# -----------------------------------------------------------------------------
####################################################################################################################
from argparse import ArgumentParser
#
if __name__ == '__main__':
    parser = ArgumentParser()
    parser.add_argument('--ip',           type=str,   default = "127.0.0.1",    help='DLT Viewer Server Host')
    parser.add_argument('--port',         type=int,   default = 20015,  help='DLT Viewer Server Port')
    #parser.add_argument('--executable',   type=str,   default = "D:/Workspace/APPS/Setup/DLTViewer-2.19.0-WORKING-5.8-r711_x64/dlt_viewer.exe",     help='Path to DLT Viewer Executable'        )
    parser.add_argument('--projectfile',  type=str,   default = "./config/DLTconfig.dlp",   help='Path to DLT Project File')
    parser.add_argument('--logger',       type=str,   default = "../logger/configuration.json", help='Logger configuration')
  
    args = parser.parse_args()
    # main 
    main(vars(args))
####################################################################################################################
# -----------------------------------------------------------------------------
# end
# -----------------------------------------------------------------------------
####################################################################################################################
